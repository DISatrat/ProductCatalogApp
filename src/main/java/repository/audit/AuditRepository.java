package repository.audit;

import model.AuditEntry;

import java.util.List;

/**
 * Репозиторий для управления записями аудита в системе.
 * Предоставляет методы для записи действий пользователей и получения записей аудита
 * для целей мониторинга безопасности и соблюдения нормативных требований.
 */
public interface AuditRepository {
    /**
     * Записывает новую запись аудита с указанными деталями действия пользователя.
     * Запись включает временную метку, имя пользователя, тип действия и описательные детали
     * для отслеживания активности пользователей и системных событий.
     *
     * @param username имя пользователя, выполнившего действие
     * @param action тип выполненного действия (например, LOGIN, CREATE, UPDATE, DELETE)
     * @param details дополнительные детали и контекст действия
     * @throws IllegalArgumentException если любой из параметров равен null или пустой строке
     */
    void record(String username, String action, String details);

    /**
     * Возвращает список всех записей аудита из системы.
     * Записи обычно возвращаются в хронологическом порядке от самых новых к самым старым.
     *
     * @return список объектов AuditEntry, представляющих записи аудита
     */
    List<AuditEntry> getEntries();
}
